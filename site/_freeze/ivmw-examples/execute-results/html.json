{
  "hash": "ba81b3d71777e635a818cf1f9a582a54",
  "result": {
    "markdown": "---\ntitle: \"Moving window estimator\"\npagetitle: ivmw-examples\n---\n\n\n\n\n\n\nRead in simulated data with different outcome-exposure relationships; `y#` outcome, `x` exposure, `g` instrumental variable (genotype).\n\n::: {.cell collectcode='true'}\n\n```{.stata .cell-code}\nuse ../data/ivmwdata, clear\n```\n:::\n\n\nPlot outcome-exposure relationships\n\n::: {.cell}\n\n```{.stata .cell-code}\ntwoway line y1 x, sort(x)\nqui gr export ./img/ivmw-plot-01.svg, replace\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./img/ivmw-plot-01.svg){fig-align='center' fig-alt='Plot of relationship between y1 and x.'}\n:::\n:::\n\n::: {.cell}\n\n```{.stata .cell-code}\ntwoway line y2 y3 y4 x, sort(x)\nqui gr export ./img/ivmw-plot-02.svg, replace\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./img/ivmw-plot-02.svg){fig-align='center' fig-alt='Plot of relationships between y2, y3, y4, and x.'}\n:::\n:::\n\n::: {.cell}\n\n```{.stata .cell-code}\ntwoway line y5 x, sort(x)\nqui gr export ./img/ivmw-plot-03.svg, replace\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./img/ivmw-plot-03.svg){fig-align='center' fig-alt='Plot of relationship between y5 and x.'}\n:::\n:::\n\n    \nExample moving window fits.\n\n::: {.cell}\n\n```{.stata .cell-code}\nivmw, window(3950) par(x): ivreg2 y1 (x = g)\nqui gr export ./img/ivmw-plot-04.svg, replace\n```\n\n\n::: {.cell-output .cell-output-stdout}\n```\nTime variable: res_order, 1 to 4000\n        Delta: 1 unit\n(running ivreg2 on estimation sample)\n\nRolling replications (51)\n----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 \n..................................................    50\n.\nfile /var/folders/ly/ywcn0q251jj24qrshjnt1jjc0000gp/T//S_24232.000001 saved as .dta format\n(rolling: ivreg2)\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./img/ivmw-plot-04.svg){fig-align='center' fig-alt='Plot of estimated causal effect versus the median of the exposure in the moving window.'}\n:::\n:::\n\n::: {.cell}\n\n```{.stata .cell-code}\nivmw, window(3950) par(x): ivreg2 y2 (x = g)\nqui gr export ./img/ivmw-plot-05.svg, replace\n```\n\n\n::: {.cell-output .cell-output-stdout}\n```\nTime variable: res_order, 1 to 4000\n        Delta: 1 unit\n(running ivreg2 on estimation sample)\n\nRolling replications (51)\n----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 \n..................................................    50\n.\nfile /var/folders/ly/ywcn0q251jj24qrshjnt1jjc0000gp/T//S_24241.000001 saved as .dta format\n(rolling: ivreg2)\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./img/ivmw-plot-05.svg){fig-align='center' fig-alt='Plot of estimated causal effect versus the median of the exposure in the moving window.'}\n:::\n:::\n\n::: {.cell}\n\n```{.stata .cell-code}\nivmw, window(3950) par(x): ivreg2 y3 (x = g)\nqui gr export ./img/ivmw-plot-06.svg, replace\n```\n\n\n::: {.cell-output .cell-output-stdout}\n```\nTime variable: res_order, 1 to 4000\n        Delta: 1 unit\n(running ivreg2 on estimation sample)\n\nRolling replications (51)\n----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 \n..................................................    50\n.\nfile /var/folders/ly/ywcn0q251jj24qrshjnt1jjc0000gp/T//S_24249.000001 saved as .dta format\n(rolling: ivreg2)\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./img/ivmw-plot-06.svg){fig-align='center' fig-alt='Plot of estimated causal effect versus the median of the exposure in the moving window.'}\n:::\n:::\n\n::: {.cell}\n\n```{.stata .cell-code}\nivmw, window(3950) par(x): ivreg2 y4 (x = g)\nqui gr export ./img/ivmw-plot-07.svg, replace\n```\n\n\n::: {.cell-output .cell-output-stdout}\n```\nTime variable: res_order, 1 to 4000\n        Delta: 1 unit\n(running ivreg2 on estimation sample)\n\nRolling replications (51)\n----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 \n..................................................    50\n.\nfile /var/folders/ly/ywcn0q251jj24qrshjnt1jjc0000gp/T//S_24255.000001 saved as .dta format\n(rolling: ivreg2)\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./img/ivmw-plot-07.svg){fig-align='center' fig-alt='Plot of estimated causal effect versus the median of the exposure in the moving window.'}\n:::\n:::\n\n::: {.cell}\n\n```{.stata .cell-code}\nivmw, window(3950) par(x): ivreg2 y5 (x = g)\nqui gr export ./img/ivmw-plot-08.svg, replace\n```\n\n\n::: {.cell-output .cell-output-stdout}\n```\nTime variable: res_order, 1 to 4000\n        Delta: 1 unit\n(running ivreg2 on estimation sample)\n\nRolling replications (51)\n----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 \n..................................................    50\n.\nfile /var/folders/ly/ywcn0q251jj24qrshjnt1jjc0000gp/T//S_24262.000001 saved as .dta format\n(rolling: ivreg2)\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./img/ivmw-plot-08.svg){fig-align='center' fig-alt='Plot of estimated causal effect versus the median of the exposure in the moving window.'}\n:::\n:::\n\n\nChange window size (e.g. for outcome y2).\n\n::: {.cell}\n\n```{.stata .cell-code}\nivmw, window(3750) par(x): ivreg2 y2 (x = g)\nivmw, window(3000) par(x): ivreg2 y2 (x = g)\nivmw, window(2000) par(x): ivreg2 y2 (x = g)\nivmw, window(1000) par(x): ivreg2 y2 (x = g)\n```\n:::\n\n\nSave the moving window dataset.\n\n::: {.cell}\n\n```{.stata .cell-code}\nivmw, window(3950) par(x) saving(ivmw): ivreg2 y2 (x = g)\n```\n:::\n\n\nUse different iv commands.\n\n::: {.cell}\n\n```{.stata .cell-code}\nivmw, window(3950) par(x): ivregress 2sls y (x = z1 z2 z3)\nivmw, window(3950) par(x): ivregress liml y (x = z1 z2 z3)\nivmw, window(3950) par(x): ivregress gmm y (x = z1 z2 z3)\nivmw, window(3950) par(x): ivlsmm y (x = z1 z2 z3)\nivmw, window(3950) par(x): ivmsmm y (x = z1 z2 z3)\nivmw, window(3950) par(b1): ivtsps y (x = z1 z2 z3)\nivmw, window(3950) par(b1): ivtsps y (x = z1 z2 z3), link(logadd)\nivmw, window(3950) par(b1): ivtsps y (x = z1 z2 z3), link(logmult)\nivmw, window(3950) par(b1): ivtsps y (x = z1 z2 z3), link(logit)\nivmw, window(3950) par(b1): ivtsri y (x = z1 z2 z3)\nivmw, window(3950) par(b1): ivtsri y (x = z1 z2 z3), link(logadd)\nivmw, window(3950) par(b1): ivtsri y (x = z1 z2 z3), link(logmult)\nivmw, window(3950) par(b1): ivtsri y (x = z1 z2 z3), link(logit)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}