-------------------------------------------------------------------------------
      name:  ivmw
       log:  C:\Users\eptmp\Documents\GitHub\ivonesamplemr\cscripts\ivmw.log
  log type:  text
 opened on:  15 Sep 2021, 13:48:48

. // ivmw cscript
. // 2021-09-12
. 
. cscript ivmw adofiles ivmw
---------------------------------------------------------------------BEGIN ivmw

-> which ivmw, usesysdir
C:\Users\eptmp\Documents\GitHub\ivonesamplemr\ivmw.ado
*! version 0.1.0 12sep2021 Tom Palmer

. 
. // simulate data
. clear

. set obs 2500
number of observations (_N) was 0, now 2,500

. set seed 12345

. gen z1 = rbinomial(2, .2)

. gen z2 = rbinomial(2, .3)

. gen z3 = rbinomial(2, .4)

. gen u = rnormal()

. gen w = rnormal()

. gen x = z1 + z2 + z3 + w + u + rnormal()

. gen logitpy = -2 + x + w + u

. gen py = invlogit(logitpy)

. gen y = rbinomial(1, py)

. gen x1 = x

. gen x2 = rnormal()

. 
. // ivregress
. // ivmw: ivregress 2sls y (x = z1 z2 z3)
. 
. // ivreg2
. ivmw, window(2490) par(x): ivreg2 y (x = z1 z2 z3)
        time variable:  res_order, 1 to 2500
                delta:  1 unit
(running ivreg2 on estimation sample)

Rolling replications (11)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
...........
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivreg2)

. ivmw, window(90) par(x): ivreg2 y (x = z1 z2 z3) in 1/100
        time variable:  res_order, 1 to 2500
                delta:  1 unit
(running ivreg2 on estimation sample)

Rolling replications (11)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
...........
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivreg2)

. 
. // ivlsmm
. ivmw, window(2490) par(x): ivlsmm y (x = z1 z2 z3)
        time variable:  res_order, 1 to 2500
                delta:  1 unit
(running ivlsmm on estimation sample)

Rolling replications (11)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
...........
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivlsmm)

. 
. // ivmsmm
. ivmw, window(2490) par(x): ivmsmm y (x = z1 z2 z3)
        time variable:  res_order, 1 to 2500
                delta:  1 unit
(running ivmsmm on estimation sample)

Rolling replications (11)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
...........
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivmsmm)

. 
. // ivtsps
. ivmw, window(2490) par(b1): ivtsps y (x = z1 z2 z3)
        time variable:  res_order, 1 to 2500
                delta:  1 unit
(running ivtsps on estimation sample)

Rolling replications (11)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
...........
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivtsps)

. ivmw, window(2490) par(b1): ivtsps y (x = z1 z2 z3), link(logadd)
        time variable:  res_order, 1 to 2500
                delta:  1 unit
(running ivtsps on estimation sample)

Rolling replications (11)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
...........
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivtsps)

. ivmw, window(2490) par(b1): ivtsps y (x = z1 z2 z3), link(logmult)
        time variable:  res_order, 1 to 2500
                delta:  1 unit
(running ivtsps on estimation sample)

Rolling replications (11)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
...........
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivtsps)

. ivmw, window(2490) par(b1): ivtsps y (x = z1 z2 z3), link(logit)
        time variable:  res_order, 1 to 2500
                delta:  1 unit
(running ivtsps on estimation sample)

Rolling replications (11)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
...........
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivtsps)

. 
. // ivtsri
. ivmw, window(2490) par(b1): ivtsri y (x = z1 z2 z3)
        time variable:  res_order, 1 to 2500
                delta:  1 unit
(running ivtsri on estimation sample)

Rolling replications (11)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
...........
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivtsri)

. ivmw, window(2490) par(b1): ivtsri y (x = z1 z2 z3), link(logadd)
        time variable:  res_order, 1 to 2500
                delta:  1 unit
(running ivtsri on estimation sample)

Rolling replications (11)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
...........
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivtsri)

. ivmw, window(2490) par(b1): ivtsri y (x = z1 z2 z3), link(logmult)
        time variable:  res_order, 1 to 2500
                delta:  1 unit
(running ivtsri on estimation sample)

Rolling replications (11)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
...........
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivtsri)

. ivmw, window(2490) par(b1): ivtsri y (x = z1 z2 z3), link(logit)
        time variable:  res_order, 1 to 2500
                delta:  1 unit
(running ivtsri on estimation sample)

Rolling replications (11)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
...........
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivtsri)

. 
. // try quadratic exposure
. clear

. set obs 2500
number of observations (_N) was 0, now 2,500

. set seed 12345

. gen z1 = rbinomial(2, .2)

. gen z2 = rbinomial(2, .3)

. gen z3 = rbinomial(2, .4)

. gen u = rnormal()

. gen x = z1 + z2 + z3 + u + rnormal()

. gen logitpy = -6 + x^2 + u

. gen py = invlogit(logitpy)

. replace py = 0.99 if py == 1
(129 real changes made)

. gen y = rbinomial(1, py)

. 
. ivmw, window(2480) par(x): ivreg2 y (x = z1 z2 z3)
        time variable:  res_order, 1 to 2500
                delta:  1 unit
(running ivreg2 on estimation sample)

Rolling replications (21)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
.....................
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivreg2)

. 
. clear

. set obs 2500
number of observations (_N) was 0, now 2,500

. set seed 12345

. gen z1 = rbinomial(2, .2)

. gen z2 = rbinomial(2, .3)

. gen z3 = rbinomial(2, .4)

. gen u = rnormal()

. gen x = z1 + z2 + z3 + u + rnormal()

. gen logitpy = -6 + x^2 + u

. gen py = invlogit(logitpy)

. replace py = 0.99 if py == 1
(129 real changes made)

. gen y = rbinomial(1, py)

. 
. ivmw, window(2480) par(x): ivmsmm y (x = z1 z2 z3)
        time variable:  res_order, 1 to 2500
                delta:  1 unit
(running ivmsmm on estimation sample)

Rolling replications (21)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
.....................
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivmsmm)

. 
. // burgess, davies, thompson paper simulations
. 
. clear

. set obs 4000
number of observations (_N) was 0, now 4,000

. set seed 12345

. gen g = rbinomial(2, .3)

. gen u = runiform()

. gen ex = rexponential(1)

. gen x = .25*g + u + ex

. gen ey = rnormal()

. gen y1 = .4*x + .8*u + ey

. gen y2 = .1*x^2

. gen y3 = .2*(x - 1)^2

. gen y4 = .3*(x - 2)^2

. gen y5 = max(x - 2, 0)

. gen y6 = -.1*x^2

. gen y7 = (x - 5)^2

. 
. twoway line y1 x, sort(x)

. twoway line y2 y3 y4 x, sort(x)

. twoway line y5 x, sort(x)

. twoway line y6 y7 x, sort(x)

. 
. ivmw, window(3950) par(x): ivreg2 y1 (x = g)
        time variable:  res_order, 1 to 4000
                delta:  1 unit
(running ivreg2 on estimation sample)

Rolling replications (51)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
.
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivreg2)

. ivmw, window(3950) par(x): ivreg2 y2 (x = g)
        time variable:  res_order, 1 to 4000
                delta:  1 unit
(running ivreg2 on estimation sample)

Rolling replications (51)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
.
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivreg2)

. ivmw, window(3950) par(x): ivreg2 y3 (x = g)
        time variable:  res_order, 1 to 4000
                delta:  1 unit
(running ivreg2 on estimation sample)

Rolling replications (51)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
.
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivreg2)

. ivmw, window(3950) par(x): ivreg2 y4 (x = g)
        time variable:  res_order, 1 to 4000
                delta:  1 unit
(running ivreg2 on estimation sample)

Rolling replications (51)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
.
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivreg2)

. ivmw, window(3950) par(x): ivreg2 y5 (x = g)
        time variable:  res_order, 1 to 4000
                delta:  1 unit
(running ivreg2 on estimation sample)

Rolling replications (51)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
.
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivreg2)

. ivmw, window(3950) par(x): ivreg2 y6 (x = g)
        time variable:  res_order, 1 to 4000
                delta:  1 unit
(running ivreg2 on estimation sample)

Rolling replications (51)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
.
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivreg2)

. ivmw, window(3950) par(x): ivreg2 y7 (x = g)
        time variable:  res_order, 1 to 4000
                delta:  1 unit
(running ivreg2 on estimation sample)

Rolling replications (51)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
.
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivreg2)

. ivmw, window(2000) par(x): ivreg2 y7 (x = g)
        time variable:  res_order, 1 to 4000
                delta:  1 unit
(running ivreg2 on estimation sample)

Rolling replications (2001)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
..................................................   100
..................................................   150
..................................................   200
..................................................   250
..................................................   300
..................................................   350
..................................................   400
..................................................   450
..................................................   500
..................................................   550
..................................................   600
..................................................   650
..................................................   700
..................................................   750
..................................................   800
..................................................   850
..................................................   900
..................................................   950
..................................................  1000
..................................................  1050
..................................................  1100
..................................................  1150
..................................................  1200
..................................................  1250
..................................................  1300
..................................................  1350
..................................................  1400
..................................................  1450
..................................................  1500
..................................................  1550
..................................................  1600
..................................................  1650
..................................................  1700
..................................................  1750
..................................................  1800
..................................................  1850
..................................................  1900
..................................................  1950
..................................................  2000
.
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivreg2)

. 
. ivmw, window(200) par(x): ivreg2 y2 (x = g) in 1/500
        time variable:  res_order, 1 to 4000
                delta:  1 unit
(running ivreg2 on estimation sample)

Rolling replications (301)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
..................................................   100
..................................................   150
..................................................   200
..................................................   250
..................................................   300
.
file C:\Users\eptmp\AppData\Local\Temp\ST_54a0_000001.tmp saved
(rolling: ivreg2)

. 
. ivmw, window(3950) par(x) saving(ivmw, replace): ivreg2 y2 (x = g)
ivmw
        time variable:  res_order, 1 to 4000
                delta:  1 unit
(running ivreg2 on estimation sample)
(note: file ivmw.dta not found)

Rolling replications (51)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
.
file ivmw.dta saved
(rolling: ivreg2)

. use ivmw, clear
(rolling: ivreg2)

. list in 1/5

     +----------------------------------------------------------------------+
  1. | start |  end |     _b_x |   _b_cons |    _se_x | _se_cons |   median |
     |     1 | 3950 |  .332921 | -.1959417 | .0121513 | .0189048 | 1.352454 |
     |----------------------------------------------------------------------|
     |                                  _merge                              |
     |                             matched (3)                              |
     +----------------------------------------------------------------------+

     +----------------------------------------------------------------------+
  2. | start |  end |     _b_x |   _b_cons |    _se_x | _se_cons |   median |
     |     2 | 3951 | .3315938 | -.1936823 | .0123205 | .0191814 |    1.353 |
     |----------------------------------------------------------------------|
     |                                  _merge                              |
     |                             matched (3)                              |
     +----------------------------------------------------------------------+

     +----------------------------------------------------------------------+
  3. | start |  end |     _b_x |   _b_cons |    _se_x | _se_cons |   median |
     |     3 | 3952 | .3325185 | -.1948544 | .0123327 | .0192166 | 1.353038 |
     |----------------------------------------------------------------------|
     |                                  _merge                              |
     |                             matched (3)                              |
     +----------------------------------------------------------------------+

     +----------------------------------------------------------------------+
  4. | start |  end |     _b_x |   _b_cons |    _se_x | _se_cons |   median |
     |     4 | 3953 | .3311778 | -.1925636 | .0125066 |  .019501 | 1.353228 |
     |----------------------------------------------------------------------|
     |                                  _merge                              |
     |                             matched (3)                              |
     +----------------------------------------------------------------------+

     +----------------------------------------------------------------------+
  5. | start |  end |     _b_x |   _b_cons |    _se_x | _se_cons |   median |
     |     5 | 3954 | .3321689 | -.1938222 | .0125251 | .0195464 | 1.353999 |
     |----------------------------------------------------------------------|
     |                                  _merge                              |
     |                             matched (3)                              |
     +----------------------------------------------------------------------+

. if c(os) == "Windows" erase ivmw.dta

. else rm ivmw.dta

. 
end of do-file
      name:  ivmw
       log:  C:\Users\eptmp\Documents\GitHub\ivonesamplemr\cscripts\ivmw.log
  log type:  text
 closed on:  15 Sep 2021, 13:51:43
-------------------------------------------------------------------------------
